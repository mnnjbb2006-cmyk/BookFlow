# Form implementation generated from reading ui file 'test/New Folder/admin.ui'
#
# Created by: PyQt6 UI code generator 6.10.1
#
# WARNING: Any manual changes made to this file will be lost when pyuic6 is
# run again.  Do not edit this file unless you know what you are doing.

#should check $ for inputs

from PyQt6 import QtCore, QtGui, QtWidgets
from PyQt6.QtWidgets import QAbstractItemView
from Collections import users, books
from services import loans, requests

class Ui_MainWindow(object):

    def __init__(self, username, name):
        super().__init__()
        self.username = username
        self.name = name
    def setupUi(self, MainWindow):
        MainWindow.setObjectName("MainWindow")
        MainWindow.setEnabled(True)
        MainWindow.resize(1037, 779)
        self.centralwidget = QtWidgets.QWidget(parent=MainWindow)
        self.centralwidget.setObjectName("centralwidget")
        self.horizontalLayout = QtWidgets.QHBoxLayout(self.centralwidget)
        self.horizontalLayout.setObjectName("horizontalLayout")
        self.tabWidget = QtWidgets.QTabWidget(parent=self.centralwidget)
        self.tabWidget.setObjectName("tabWidget")
        self.tabUsers = QtWidgets.QWidget()
        self.tabUsers.setObjectName("tabUsers")
        self.horizontalLayout_2 = QtWidgets.QHBoxLayout(self.tabUsers)
        self.horizontalLayout_2.setObjectName("horizontalLayout_2")
        self.widget = QtWidgets.QWidget(parent=self.tabUsers)
        self.widget.setObjectName("widget")
        self.verticalLayout = QtWidgets.QVBoxLayout(self.widget)
        self.verticalLayout.setObjectName("verticalLayout")
        self.formLayout = QtWidgets.QFormLayout()
        self.formLayout.setObjectName("formLayout")
        self.label = QtWidgets.QLabel(parent=self.widget)
        self.label.setObjectName("label")
        self.formLayout.setWidget(0, QtWidgets.QFormLayout.ItemRole.LabelRole, self.label)
        self.lineEditUsername = QtWidgets.QLineEdit(parent=self.widget)
        self.lineEditUsername.setObjectName("lineEditUsername")
        self.formLayout.setWidget(0, QtWidgets.QFormLayout.ItemRole.FieldRole, self.lineEditUsername)
        self.label_2 = QtWidgets.QLabel(parent=self.widget)
        self.label_2.setObjectName("label_2")
        self.formLayout.setWidget(1, QtWidgets.QFormLayout.ItemRole.LabelRole, self.label_2)
        self.lineEditPassword = QtWidgets.QLineEdit(parent=self.widget)
        self.lineEditPassword.setEchoMode(QtWidgets.QLineEdit.EchoMode.Password)
        self.lineEditPassword.setObjectName("lineEditPassword")
        self.formLayout.setWidget(1, QtWidgets.QFormLayout.ItemRole.FieldRole, self.lineEditPassword)
        self.label_3 = QtWidgets.QLabel(parent=self.widget)
        self.label_3.setObjectName("label_3")
        self.formLayout.setWidget(2, QtWidgets.QFormLayout.ItemRole.LabelRole, self.label_3)
        self.lineEditName = QtWidgets.QLineEdit(parent=self.widget)
        self.lineEditName.setObjectName("lineEditName")
        self.formLayout.setWidget(2, QtWidgets.QFormLayout.ItemRole.FieldRole, self.lineEditName)
        self.label_4 = QtWidgets.QLabel(parent=self.widget)
        self.label_4.setObjectName("label_4")
        self.formLayout.setWidget(3, QtWidgets.QFormLayout.ItemRole.LabelRole, self.label_4)
        self.comboBoxRole = QtWidgets.QComboBox(parent=self.widget)
        self.comboBoxRole.setObjectName("comboBoxRole")
        self.comboBoxRole.addItem("")
        self.comboBoxRole.addItem("")
        self.comboBoxRole.addItem("")
        self.formLayout.setWidget(3, QtWidgets.QFormLayout.ItemRole.FieldRole, self.comboBoxRole)
        self.verticalLayout.addLayout(self.formLayout)
        spacerItem = QtWidgets.QSpacerItem(20, 40, QtWidgets.QSizePolicy.Policy.Minimum, QtWidgets.QSizePolicy.Policy.Expanding)
        self.verticalLayout.addItem(spacerItem)
        self.widget_2 = QtWidgets.QWidget(parent=self.widget)
        self.widget_2.setObjectName("widget_2")
        self.horizontalLayout_3 = QtWidgets.QHBoxLayout(self.widget_2)
        self.horizontalLayout_3.setObjectName("horizontalLayout_3")
        self.pushButtonAdduser = QtWidgets.QPushButton(parent=self.widget_2)
        self.pushButtonAdduser.setObjectName("pushButtonAdduser")
        self.horizontalLayout_3.addWidget(self.pushButtonAdduser)
        self.pushButtonDelete = QtWidgets.QPushButton(parent=self.widget_2)
        self.pushButtonDelete.setObjectName("pushButtonDelete")
        self.horizontalLayout_3.addWidget(self.pushButtonDelete)
        self.pushButtonEnable = QtWidgets.QPushButton(parent=self.widget_2)
        self.pushButtonEnable.setObjectName("pushButtonEnable")
        self.horizontalLayout_3.addWidget(self.pushButtonEnable)
        self.pushButtonDisable = QtWidgets.QPushButton(parent=self.widget_2)
        self.pushButtonDisable.setObjectName("pushButtonDisable")
        self.horizontalLayout_3.addWidget(self.pushButtonDisable)
        self.verticalLayout.addWidget(self.widget_2)
        self.horizontalLayout_2.addWidget(self.widget)
        self.tableWidgetUsers = QtWidgets.QTableWidget(parent=self.tabUsers)
        self.tableWidgetUsers.setObjectName("tableWidgetUsers")
        self.tableWidgetUsers.setColumnCount(5)
        self.tableWidgetUsers.setRowCount(0)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidgetUsers.setHorizontalHeaderItem(0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidgetUsers.setHorizontalHeaderItem(1, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidgetUsers.setHorizontalHeaderItem(2, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidgetUsers.setHorizontalHeaderItem(3, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidgetUsers.setHorizontalHeaderItem(4, item)
        self.horizontalLayout_2.addWidget(self.tableWidgetUsers)
        self.tabWidget.addTab(self.tabUsers, "")
        self.tabBooks = QtWidgets.QWidget()
        self.tabBooks.setObjectName("tabBooks")
        self.horizontalLayout_6 = QtWidgets.QHBoxLayout(self.tabBooks)
        self.horizontalLayout_6.setObjectName("horizontalLayout_6")
        self.widget_4 = QtWidgets.QWidget(parent=self.tabBooks)
        self.widget_4.setObjectName("widget_4")
        self.horizontalLayout_4 = QtWidgets.QHBoxLayout(self.widget_4)
        self.horizontalLayout_4.setObjectName("horizontalLayout_4")
        self.horizontalLayout_6.addWidget(self.widget_4)
        self.widget_3 = QtWidgets.QWidget(parent=self.tabBooks)
        self.widget_3.setObjectName("widget_3")
        self.verticalLayout_2 = QtWidgets.QVBoxLayout(self.widget_3)
        self.verticalLayout_2.setObjectName("verticalLayout_2")
        self.label_5 = QtWidgets.QLabel(parent=self.widget_3)
        self.label_5.setObjectName("label_5")
        self.verticalLayout_2.addWidget(self.label_5)
        self.formLayout_2 = QtWidgets.QFormLayout()
        self.formLayout_2.setObjectName("formLayout_2")
        self.label_6 = QtWidgets.QLabel(parent=self.widget_3)
        self.label_6.setObjectName("label_6")
        self.formLayout_2.setWidget(0, QtWidgets.QFormLayout.ItemRole.LabelRole, self.label_6)
        self.label_7 = QtWidgets.QLabel(parent=self.widget_3)
        self.label_7.setObjectName("label_7")
        self.formLayout_2.setWidget(1, QtWidgets.QFormLayout.ItemRole.LabelRole, self.label_7)
        self.label_8 = QtWidgets.QLabel(parent=self.widget_3)
        self.label_8.setObjectName("label_8")
        self.formLayout_2.setWidget(2, QtWidgets.QFormLayout.ItemRole.LabelRole, self.label_8)
        self.label_9 = QtWidgets.QLabel(parent=self.widget_3)
        self.label_9.setObjectName("label_9")
        self.formLayout_2.setWidget(3, QtWidgets.QFormLayout.ItemRole.LabelRole, self.label_9)
        self.lineEditTitle = QtWidgets.QLineEdit(parent=self.widget_3)
        self.lineEditTitle.setObjectName("lineEditTitle")
        self.formLayout_2.setWidget(0, QtWidgets.QFormLayout.ItemRole.FieldRole, self.lineEditTitle)
        self.lineEditAuthor = QtWidgets.QLineEdit(parent=self.widget_3)
        self.lineEditAuthor.setObjectName("lineEditAuthor")
        self.formLayout_2.setWidget(1, QtWidgets.QFormLayout.ItemRole.FieldRole, self.lineEditAuthor)
        self.lineEditCategory = QtWidgets.QLineEdit(parent=self.widget_3)
        self.lineEditCategory.setObjectName("lineEditCategory")
        self.formLayout_2.setWidget(2, QtWidgets.QFormLayout.ItemRole.FieldRole, self.lineEditCategory)
        self.spinBoxTotalcount = QtWidgets.QSpinBox(parent=self.widget_3)
        self.spinBoxTotalcount.setObjectName("spinBoxTotalcount")
        self.formLayout_2.setWidget(3, QtWidgets.QFormLayout.ItemRole.FieldRole, self.spinBoxTotalcount)
        self.verticalLayout_2.addLayout(self.formLayout_2)
        self.label_11 = QtWidgets.QLabel(parent=self.widget_3)
        self.label_11.setObjectName("label_11")
        self.verticalLayout_2.addWidget(self.label_11)
        self.formLayout_3 = QtWidgets.QFormLayout()
        self.formLayout_3.setObjectName("formLayout_3")
        self.label_10 = QtWidgets.QLabel(parent=self.widget_3)
        self.label_10.setObjectName("label_10")
        self.formLayout_3.setWidget(0, QtWidgets.QFormLayout.ItemRole.LabelRole, self.label_10)
        self.lineEditTitle2 = QtWidgets.QLineEdit(parent=self.widget_3)
        self.lineEditTitle2.setObjectName("lineEditTitle2")
        self.formLayout_3.setWidget(0, QtWidgets.QFormLayout.ItemRole.FieldRole, self.lineEditTitle2)
        self.label_12 = QtWidgets.QLabel(parent=self.widget_3)
        self.label_12.setObjectName("label_12")
        self.formLayout_3.setWidget(1, QtWidgets.QFormLayout.ItemRole.LabelRole, self.label_12)
        self.lineEditAuthor2 = QtWidgets.QLineEdit(parent=self.widget_3)
        self.lineEditAuthor2.setObjectName("lineEditAuthor2")
        self.formLayout_3.setWidget(1, QtWidgets.QFormLayout.ItemRole.FieldRole, self.lineEditAuthor2)
        self.label_13 = QtWidgets.QLabel(parent=self.widget_3)
        self.label_13.setObjectName("label_13")
        self.formLayout_3.setWidget(2, QtWidgets.QFormLayout.ItemRole.LabelRole, self.label_13)
        self.lineEditCategory2 = QtWidgets.QLineEdit(parent=self.widget_3)
        self.lineEditCategory2.setObjectName("lineEditCategory2")
        self.formLayout_3.setWidget(2, QtWidgets.QFormLayout.ItemRole.FieldRole, self.lineEditCategory2)
        self.verticalLayout_2.addLayout(self.formLayout_3)
        self.widget_5 = QtWidgets.QWidget(parent=self.widget_3)
        self.widget_5.setObjectName("widget_5")
        self.horizontalLayout_5 = QtWidgets.QHBoxLayout(self.widget_5)
        self.horizontalLayout_5.setObjectName("horizontalLayout_5")
        self.pushButtonSearch = QtWidgets.QPushButton(parent=self.widget_5)
        self.pushButtonSearch.setObjectName("pushButtonSearch")
        self.horizontalLayout_5.addWidget(self.pushButtonSearch)
        self.pushButtonClear2 = QtWidgets.QPushButton(parent=self.widget_5)
        self.pushButtonClear2.setObjectName("pushButtonClear2")
        self.horizontalLayout_5.addWidget(self.pushButtonClear2)
        self.verticalLayout_2.addWidget(self.widget_5)
        spacerItem1 = QtWidgets.QSpacerItem(20, 40, QtWidgets.QSizePolicy.Policy.Minimum, QtWidgets.QSizePolicy.Policy.Expanding)
        self.verticalLayout_2.addItem(spacerItem1)
        self.widget_6 = QtWidgets.QWidget(parent=self.widget_3)
        self.widget_6.setObjectName("widget_6")
        self.horizontalLayout_7 = QtWidgets.QHBoxLayout(self.widget_6)
        self.horizontalLayout_7.setObjectName("horizontalLayout_7")
        self.pushButtonAdd = QtWidgets.QPushButton(parent=self.widget_6)
        self.pushButtonAdd.setObjectName("pushButtonAdd")
        self.horizontalLayout_7.addWidget(self.pushButtonAdd)
        self.pushButtonEditselected = QtWidgets.QPushButton(parent=self.widget_6)
        self.pushButtonEditselected.setObjectName("pushButtonEditselected")
        self.horizontalLayout_7.addWidget(self.pushButtonEditselected)
        self.pushButtonDeleteselected = QtWidgets.QPushButton(parent=self.widget_6)
        self.pushButtonDeleteselected.setObjectName("pushButtonDeleteselected")
        self.horizontalLayout_7.addWidget(self.pushButtonDeleteselected)
        self.pushButtonClear = QtWidgets.QPushButton(parent=self.widget_6)
        self.pushButtonClear.setObjectName("pushButtonClear")
        self.horizontalLayout_7.addWidget(self.pushButtonClear)
        self.verticalLayout_2.addWidget(self.widget_6)
        self.horizontalLayout_6.addWidget(self.widget_3)
        self.tableWidgetBooks = QtWidgets.QTableWidget(parent=self.tabBooks)
        self.tableWidgetBooks.setObjectName("tableWidgetBooks")
        self.tableWidgetBooks.setColumnCount(7)
        self.tableWidgetBooks.setRowCount(0)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidgetBooks.setHorizontalHeaderItem(0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidgetBooks.setHorizontalHeaderItem(1, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidgetBooks.setHorizontalHeaderItem(2, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidgetBooks.setHorizontalHeaderItem(3, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidgetBooks.setHorizontalHeaderItem(4, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidgetBooks.setHorizontalHeaderItem(5, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidgetBooks.setHorizontalHeaderItem(6, item)
        self.horizontalLayout_6.addWidget(self.tableWidgetBooks)
        self.tabWidget.addTab(self.tabBooks, "")
        self.tabRequests = QtWidgets.QWidget()
        self.tabRequests.setObjectName("tabRequests")
        self.verticalLayout_3 = QtWidgets.QVBoxLayout(self.tabRequests)
        self.verticalLayout_3.setObjectName("verticalLayout_3")
        self.widget_7 = QtWidgets.QWidget(parent=self.tabRequests)
        self.widget_7.setObjectName("widget_7")
        self.horizontalLayout_8 = QtWidgets.QHBoxLayout(self.widget_7)
        self.horizontalLayout_8.setObjectName("horizontalLayout_8")
        self.label_14 = QtWidgets.QLabel(parent=self.widget_7)
        self.label_14.setObjectName("label_14")
        self.horizontalLayout_8.addWidget(self.label_14)
        self.lineEditUsername2 = QtWidgets.QLineEdit(parent=self.widget_7)
        self.lineEditUsername2.setObjectName("lineEditUsername2")
        self.horizontalLayout_8.addWidget(self.lineEditUsername2)
        self.label_15 = QtWidgets.QLabel(parent=self.widget_7)
        self.label_15.setObjectName("label_15")
        self.horizontalLayout_8.addWidget(self.label_15)
        self.comboBoxStatus = QtWidgets.QComboBox(parent=self.widget_7)
        self.comboBoxStatus.setObjectName("comboBoxStatus")
        self.comboBoxStatus.addItem("")
        self.comboBoxStatus.addItem("")
        self.comboBoxStatus.addItem("")
        self.comboBoxStatus.addItem("")
        self.horizontalLayout_8.addWidget(self.comboBoxStatus)
        self.pushButtonLoad = QtWidgets.QPushButton(parent=self.widget_7)
        self.pushButtonLoad.setObjectName("pushButtonLoad")
        self.horizontalLayout_8.addWidget(self.pushButtonLoad)
        spacerItem2 = QtWidgets.QSpacerItem(40, 20, QtWidgets.QSizePolicy.Policy.Expanding, QtWidgets.QSizePolicy.Policy.Minimum)
        self.horizontalLayout_8.addItem(spacerItem2)
        self.verticalLayout_3.addWidget(self.widget_7)
        self.tableWidgetRequests = QtWidgets.QTableWidget(parent=self.tabRequests)
        self.tableWidgetRequests.setObjectName("tableWidgetRequests")
        self.tableWidgetRequests.setColumnCount(12)
        self.tableWidgetRequests.setRowCount(0)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidgetRequests.setHorizontalHeaderItem(0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidgetRequests.setHorizontalHeaderItem(1, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidgetRequests.setHorizontalHeaderItem(2, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidgetRequests.setHorizontalHeaderItem(3, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidgetRequests.setHorizontalHeaderItem(4, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidgetRequests.setHorizontalHeaderItem(5, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidgetRequests.setHorizontalHeaderItem(6, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidgetRequests.setHorizontalHeaderItem(7, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidgetRequests.setHorizontalHeaderItem(8, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidgetRequests.setHorizontalHeaderItem(9, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidgetRequests.setHorizontalHeaderItem(10, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidgetRequests.setHorizontalHeaderItem(11, item)
        self.verticalLayout_3.addWidget(self.tableWidgetRequests)
        self.widget_10 = QtWidgets.QWidget(parent=self.tabRequests)
        self.widget_10.setMinimumSize(QtCore.QSize(0, 0))
        self.widget_10.setObjectName("widget_10")
        self.horizontalLayout_11 = QtWidgets.QHBoxLayout(self.widget_10)
        self.horizontalLayout_11.setObjectName("horizontalLayout_11")
        spacerItem3 = QtWidgets.QSpacerItem(40, 20, QtWidgets.QSizePolicy.Policy.Expanding, QtWidgets.QSizePolicy.Policy.Minimum)
        self.horizontalLayout_11.addItem(spacerItem3)
        self.pushButtonAccept = QtWidgets.QPushButton(parent=self.widget_10)
        self.pushButtonAccept.setEnabled(False)
        self.pushButtonAccept.setObjectName("pushButtonAccept")
        self.horizontalLayout_11.addWidget(self.pushButtonAccept)
        self.pushButtonReject = QtWidgets.QPushButton(parent=self.widget_10)
        self.pushButtonReject.setEnabled(False)
        self.pushButtonReject.setObjectName("pushButtonReject")
        self.horizontalLayout_11.addWidget(self.pushButtonReject)
        self.verticalLayout_3.addWidget(self.widget_10)
        self.tabWidget.addTab(self.tabRequests, "")
        self.tab = QtWidgets.QWidget()
        self.tab.setObjectName("tab")
        self.verticalLayout_4 = QtWidgets.QVBoxLayout(self.tab)
        self.verticalLayout_4.setObjectName("verticalLayout_4")
        self.label_16 = QtWidgets.QLabel(parent=self.tab)
        self.label_16.setObjectName("label_16")
        self.verticalLayout_4.addWidget(self.label_16)
        self.widget_8 = QtWidgets.QWidget(parent=self.tab)
        self.widget_8.setObjectName("widget_8")
        self.horizontalLayout_9 = QtWidgets.QHBoxLayout(self.widget_8)
        self.horizontalLayout_9.setObjectName("horizontalLayout_9")
        self.label_17 = QtWidgets.QLabel(parent=self.widget_8)
        self.label_17.setObjectName("label_17")
        self.horizontalLayout_9.addWidget(self.label_17)
        self.spinBoxLoaned = QtWidgets.QSpinBox(parent=self.widget_8)
        self.spinBoxLoaned.setObjectName("spinBoxLoaned")
        self.horizontalLayout_9.addWidget(self.spinBoxLoaned)
        spacerItem4 = QtWidgets.QSpacerItem(40, 20, QtWidgets.QSizePolicy.Policy.Expanding, QtWidgets.QSizePolicy.Policy.Minimum)
        self.horizontalLayout_9.addItem(spacerItem4)
        self.pushButtonRefreshTopbooks = QtWidgets.QPushButton(parent=self.widget_8)
        self.pushButtonRefreshTopbooks.setObjectName("pushButtonRefreshTopbooks")
        self.horizontalLayout_9.addWidget(self.pushButtonRefreshTopbooks)
        self.verticalLayout_4.addWidget(self.widget_8)
        self.tableWidget = QtWidgets.QTableWidget(parent=self.tab)
        self.tableWidget.setObjectName("tableWidget")
        self.tableWidget.setColumnCount(7)
        self.tableWidget.setRowCount(0)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setHorizontalHeaderItem(0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setHorizontalHeaderItem(1, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setHorizontalHeaderItem(2, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setHorizontalHeaderItem(3, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setHorizontalHeaderItem(4, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setHorizontalHeaderItem(5, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setHorizontalHeaderItem(6, item)
        self.verticalLayout_4.addWidget(self.tableWidget)
        self.label_19 = QtWidgets.QLabel(parent=self.tab)
        self.label_19.setObjectName("label_19")
        self.verticalLayout_4.addWidget(self.label_19)
        self.widget_9 = QtWidgets.QWidget(parent=self.tab)
        self.widget_9.setObjectName("widget_9")
        self.horizontalLayout_10 = QtWidgets.QHBoxLayout(self.widget_9)
        self.horizontalLayout_10.setObjectName("horizontalLayout_10")
        self.label_18 = QtWidgets.QLabel(parent=self.widget_9)
        self.label_18.setObjectName("label_18")
        self.horizontalLayout_10.addWidget(self.label_18)
        self.spinBoxPenalty = QtWidgets.QSpinBox(parent=self.widget_9)
        self.spinBoxPenalty.setObjectName("spinBoxPenalty")
        self.horizontalLayout_10.addWidget(self.spinBoxPenalty)
        spacerItem5 = QtWidgets.QSpacerItem(40, 20, QtWidgets.QSizePolicy.Policy.Expanding, QtWidgets.QSizePolicy.Policy.Minimum)
        self.horizontalLayout_10.addItem(spacerItem5)
        self.pushButtonLowpenalty = QtWidgets.QPushButton(parent=self.widget_9)
        self.pushButtonLowpenalty.setObjectName("pushButtonLowpenalty")
        self.horizontalLayout_10.addWidget(self.pushButtonLowpenalty)
        self.verticalLayout_4.addWidget(self.widget_9)
        self.tableWidget_2 = QtWidgets.QTableWidget(parent=self.tab)
        self.tableWidget_2.setObjectName("tableWidget_2")
        self.tableWidget_2.setColumnCount(3)
        self.tableWidget_2.setRowCount(0)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_2.setHorizontalHeaderItem(0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_2.setHorizontalHeaderItem(1, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget_2.setHorizontalHeaderItem(2, item)
        self.verticalLayout_4.addWidget(self.tableWidget_2)
        self.tabWidget.addTab(self.tab, "")
        self.horizontalLayout.addWidget(self.tabWidget)
        MainWindow.setCentralWidget(self.centralwidget)
        self.menubar = QtWidgets.QMenuBar(parent=MainWindow)
        self.menubar.setGeometry(QtCore.QRect(0, 0, 1037, 27))
        self.menubar.setObjectName("menubar")
        self.menuAccount = QtWidgets.QMenu(parent=self.menubar)
        self.menuAccount.setObjectName("menuAccount")
        MainWindow.setMenuBar(self.menubar)
        self.statusbar = QtWidgets.QStatusBar(parent=MainWindow)
        self.statusbar.setObjectName("statusbar")
        MainWindow.setStatusBar(self.statusbar)
        self.actionLogin = QtGui.QAction(parent=MainWindow)
        self.actionLogin.setObjectName("actionLogin")
        self.menuAccount.addAction(self.actionLogin)
        self.menubar.addAction(self.menuAccount.menuAction())

        self.retranslateUi(MainWindow)
        self.tabWidget.setCurrentIndex(3)
        QtCore.QMetaObject.connectSlotsByName(MainWindow)


    def retranslateUi(self, MainWindow):
        _translate = QtCore.QCoreApplication.translate
        MainWindow.setWindowTitle(_translate("MainWindow", "BookFlow"))
        self.label.setText(_translate("MainWindow", "Username:"))
        self.label_2.setText(_translate("MainWindow", "Password:"))
        self.label_3.setText(_translate("MainWindow", "Full Name:"))
        self.label_4.setText(_translate("MainWindow", "Role:"))
        self.comboBoxRole.setItemText(0, _translate("MainWindow", "Admin"))
        self.comboBoxRole.setItemText(1, _translate("MainWindow", "Librarian"))
        self.comboBoxRole.setItemText(2, _translate("MainWindow", "User"))
        self.pushButtonAdduser.setText(_translate("MainWindow", "Add User"))
        self.pushButtonDelete.setText(_translate("MainWindow", "Delete selected"))
        self.pushButtonEnable.setText(_translate("MainWindow", "Enable selected"))
        self.pushButtonDisable.setText(_translate("MainWindow", "Disable selected"))
        item = self.tableWidgetUsers.horizontalHeaderItem(0)
        item.setText(_translate("MainWindow", "Username"))
        item = self.tableWidgetUsers.horizontalHeaderItem(1)
        item.setText(_translate("MainWindow", "Name"))
        item = self.tableWidgetUsers.horizontalHeaderItem(2)
        item.setText(_translate("MainWindow", "Role"))
        item = self.tableWidgetUsers.horizontalHeaderItem(3)
        item.setText(_translate("MainWindow", "Status"))
        item = self.tableWidgetUsers.horizontalHeaderItem(4)
        item.setText(_translate("MainWindow", "Penalty"))
        self.tabWidget.setTabText(self.tabWidget.indexOf(self.tabUsers), _translate("MainWindow", "Users"))
        self.label_5.setText(_translate("MainWindow", "Book details"))
        self.label_6.setText(_translate("MainWindow", "TItle:"))
        self.label_7.setText(_translate("MainWindow", "Author:"))
        self.label_8.setText(_translate("MainWindow", "Category:"))
        self.label_9.setText(_translate("MainWindow", "Total count:"))
        self.label_11.setText(_translate("MainWindow", "Search filters"))
        self.label_10.setText(_translate("MainWindow", "Tiltle:"))
        self.label_12.setText(_translate("MainWindow", "Author"))
        self.label_13.setText(_translate("MainWindow", "Category:"))
        self.pushButtonSearch.setText(_translate("MainWindow", "Search"))
        self.pushButtonClear2.setText(_translate("MainWindow", "Clear search"))
        self.pushButtonAdd.setText(_translate("MainWindow", "Add"))
        self.pushButtonEditselected.setText(_translate("MainWindow", "Edit selected"))
        self.pushButtonDeleteselected.setText(_translate("MainWindow", "Delete selected"))
        self.pushButtonClear.setText(_translate("MainWindow", "Clear"))
        item = self.tableWidgetBooks.horizontalHeaderItem(0)
        item.setText(_translate("MainWindow", "Title"))
        item = self.tableWidgetBooks.horizontalHeaderItem(1)
        item.setText(_translate("MainWindow", "Author"))
        item = self.tableWidgetBooks.horizontalHeaderItem(2)
        item.setText(_translate("MainWindow", "Category"))
        item = self.tableWidgetBooks.horizontalHeaderItem(3)
        item.setText(_translate("MainWindow", "Total count"))
        item = self.tableWidgetBooks.horizontalHeaderItem(4)
        item.setText(_translate("MainWindow", "Available count"))
        item = self.tableWidgetBooks.horizontalHeaderItem(5)
        item.setText(_translate("MainWindow", "Loans"))
        item = self.tableWidgetBooks.horizontalHeaderItem(6)
        item.setText(_translate("MainWindow", "Loaned"))
        self.tabWidget.setTabText(self.tabWidget.indexOf(self.tabBooks), _translate("MainWindow", "Books"))
        self.label_14.setText(_translate("MainWindow", "Username Contains:"))
        self.label_15.setText(_translate("MainWindow", "Status:"))
        self.comboBoxStatus.setItemText(0, _translate("MainWindow", "All"))
        self.comboBoxStatus.setItemText(1, _translate("MainWindow", "Accepted"))
        self.comboBoxStatus.setItemText(2, _translate("MainWindow", "Rejected"))
        self.comboBoxStatus.setItemText(3, _translate("MainWindow", "Pending"))
        self.pushButtonLoad.setText(_translate("MainWindow", "Load"))
        item = self.tableWidgetRequests.horizontalHeaderItem(0)
        item.setText(_translate("MainWindow", "Username"))
        item = self.tableWidgetRequests.horizontalHeaderItem(1)
        item.setText(_translate("MainWindow", "Title"))
        item = self.tableWidgetRequests.horizontalHeaderItem(2)
        item.setText(_translate("MainWindow", "Author"))
        item = self.tableWidgetRequests.horizontalHeaderItem(3)
        item.setText(_translate("MainWindow", "Category"))
        item = self.tableWidgetRequests.horizontalHeaderItem(4)
        item.setText(_translate("MainWindow", "Total count"))
        item = self.tableWidgetRequests.horizontalHeaderItem(5)
        item.setText(_translate("MainWindow", "Available count"))
        item = self.tableWidgetRequests.horizontalHeaderItem(6)
        item.setText(_translate("MainWindow", "Loans (book)"))
        item = self.tableWidgetRequests.horizontalHeaderItem(7)
        item.setText(_translate("MainWindow", "Loaned"))
        item = self.tableWidgetRequests.horizontalHeaderItem(8)
        item.setText(_translate("MainWindow", "Type"))
        item = self.tableWidgetRequests.horizontalHeaderItem(9)
        item.setText(_translate("MainWindow", "Status"))
        item = self.tableWidgetRequests.horizontalHeaderItem(10)
        item.setText(_translate("MainWindow", "Request date"))
        item = self.tableWidgetRequests.horizontalHeaderItem(11)
        item.setText(_translate("MainWindow", "Duration"))
        self.pushButtonAccept.setText(_translate("MainWindow", "Accept Selected"))
        self.pushButtonReject.setText(_translate("MainWindow", "Reject Selected"))
        self.tabWidget.setTabText(self.tabWidget.indexOf(self.tabRequests), _translate("MainWindow", "Requests"))
        self.label_16.setText(_translate("MainWindow", "Top loaned books"))
        self.label_17.setText(_translate("MainWindow", "Count:"))
        self.pushButtonRefreshTopbooks.setText(_translate("MainWindow", "Refresh"))
        item = self.tableWidget.horizontalHeaderItem(0)
        item.setText(_translate("MainWindow", "Title"))
        item = self.tableWidget.horizontalHeaderItem(1)
        item.setText(_translate("MainWindow", "Author"))
        item = self.tableWidget.horizontalHeaderItem(2)
        item.setText(_translate("MainWindow", "Category"))
        item = self.tableWidget.horizontalHeaderItem(3)
        item.setText(_translate("MainWindow", "Total count"))
        item = self.tableWidget.horizontalHeaderItem(4)
        item.setText(_translate("MainWindow", "Available count"))
        item = self.tableWidget.horizontalHeaderItem(5)
        item.setText(_translate("MainWindow", "Loanes"))
        item = self.tableWidget.horizontalHeaderItem(6)
        item.setText(_translate("MainWindow", "Loaned"))
        self.label_19.setText(_translate("MainWindow", "Low-penalty users"))
        self.label_18.setText(_translate("MainWindow", "Count:"))
        self.pushButtonLowpenalty.setText(_translate("MainWindow", "Refresh"))
        item = self.tableWidget_2.horizontalHeaderItem(0)
        item.setText(_translate("MainWindow", "Username"))
        item = self.tableWidget_2.horizontalHeaderItem(1)
        item.setText(_translate("MainWindow", "Name"))
        item = self.tableWidget_2.horizontalHeaderItem(2)
        item.setText(_translate("MainWindow", "Penalty"))
        self.tabWidget.setTabText(self.tabWidget.indexOf(self.tab), _translate("MainWindow", "Reports"))
        self.menuAccount.setTitle(_translate("MainWindow", "Account"))
        self.actionLogin.setText(_translate("MainWindow", "Logout"))
        self.setupActions()
        self.refresh_users()
        self.refresh_books()
        self.load_requests()
    def setupActions(self):
        ###############       /tab users/              #####################################
        self.pushButtonSearch.clicked.connect(self.findbooks)
        self.pushButtonAdduser.clicked.connect(self.add_user)
        self.pushButtonDelete.setDisabled(1)
        self.pushButtonDelete.clicked.connect(self.del_user)
        self.pushButtonEnable.setDisabled(1)
        self.pushButtonEnable.clicked.connect(self.enable_user)
        self.pushButtonDisable.setDisabled(1)
        self.pushButtonDisable.clicked.connect(self.disable_user)
        self.tableWidgetUsers.setSelectionBehavior(QtWidgets.QAbstractItemView.SelectionBehavior.SelectRows)
        self.tableWidgetUsers.setEditTriggers(QtWidgets.QAbstractItemView.EditTrigger.NoEditTriggers)
        self.tableWidgetUsers.setSelectionMode(QtWidgets.QAbstractItemView.SelectionMode.SingleSelection)
        self.tableWidgetUsers.itemSelectionChanged.connect(self.user_selection_changed)
        ###############       /tab books/              #####################################
        self.pushButtonAdd.clicked.connect(self.add_book)
        self.pushButtonDeleteselected.setDisabled(1)
        self.pushButtonDeleteselected.clicked.connect(self.del_book)
        self.pushButtonEditselected.setDisabled(1)
        self.pushButtonEditselected.clicked.connect(self.edit_book)
        self.pushButtonClear.clicked.connect(self.clear_book)
        self.pushButtonClear2.clicked.connect(self.clear_book_search)
        self.tableWidgetBooks.setSelectionBehavior(QtWidgets.QAbstractItemView.SelectionBehavior.SelectRows)
        self.tableWidgetBooks.setEditTriggers(QtWidgets.QAbstractItemView.EditTrigger.NoEditTriggers)
        self.tableWidgetBooks.setSelectionMode(QtWidgets.QAbstractItemView.SelectionMode.SingleSelection)
        self.tableWidgetBooks.itemSelectionChanged.connect(self.book_selection_changed)
        ###############       /tab requests/              #####################################
        self.tableWidgetRequests.setSelectionBehavior(QtWidgets.QAbstractItemView.SelectionBehavior.SelectRows)
        self.tableWidgetRequests.setEditTriggers(QtWidgets.QAbstractItemView.EditTrigger.NoEditTriggers)
        self.tableWidgetRequests.setSelectionMode(QtWidgets.QAbstractItemView.SelectionMode.SingleSelection)
        self.tableWidgetRequests.itemSelectionChanged.connect(self.request_selection_changed)
        self.pushButtonAccept.clicked.connect(self.accept_request)
        self.pushButtonLoad.clicked.connect(self.load_requests)
        self.pushButtonReject.clicked.connect(self.reject_request)
        ###############       /tab reports/              #####################################
        #clear buttion should be deleted
        self.tableWidget.setSelectionBehavior(QtWidgets.QAbstractItemView.SelectionBehavior.SelectRows)
        self.tableWidget.setEditTriggers(QtWidgets.QAbstractItemView.EditTrigger.NoEditTriggers)
        self.tableWidget.setSelectionMode(QtWidgets.QAbstractItemView.SelectionMode.SingleSelection)
        self.tableWidget_2.setSelectionBehavior(QtWidgets.QAbstractItemView.SelectionBehavior.SelectRows)
        self.tableWidget_2.setEditTriggers(QtWidgets.QAbstractItemView.EditTrigger.NoEditTriggers)
        self.tableWidget_2.setSelectionMode(QtWidgets.QAbstractItemView.SelectionMode.SingleSelection)
        self.spinBoxLoaned.setValue(10)
        self.spinBoxPenalty.setValue(10)
        self.refresh_books()
        self.refresh_low_penalty()
        self.refresh_top_books()
        self.pushButtonRefreshTopbooks.clicked.connect(self.refresh_top_books)
        self.pushButtonLowpenalty.clicked.connect(self.refresh_low_penalty)

#####################           /functions/                   ###################################################################################################################################################

    def load_requests(self):
        try:
            self.tableWidgetRequests.setRowCount(0)
            u = self.lineEditUsername2.text()
            status = self.comboBoxStatus.currentText().lower()
            for request in requests.all_requests(u, status):
                book = books.findbooks(_id=request.get("book id", ""))
                rowPosition = self.tableWidgetRequests.rowCount()
                self.tableWidgetRequests.insertRow(rowPosition)
                self.tableWidgetRequests.setItem(rowPosition , 0, QtWidgets.QTableWidgetItem(request.get("username", "")))
                self.tableWidgetRequests.setItem(rowPosition , 1, QtWidgets.QTableWidgetItem(book.get("title", "")))
                self.tableWidgetRequests.setItem(rowPosition , 2, QtWidgets.QTableWidgetItem(book.get("author", "")))
                self.tableWidgetRequests.setItem(rowPosition , 3, QtWidgets.QTableWidgetItem(book.get("category", "")))
                self.tableWidgetRequests.setItem(rowPosition , 4, QtWidgets.QTableWidgetItem(str(book.get("total count", ""))))
                self.tableWidgetRequests.setItem(rowPosition , 5, QtWidgets.QTableWidgetItem(str(book.get("available count", ""))))
                self.tableWidgetRequests.setItem(rowPosition , 6, QtWidgets.QTableWidgetItem(str(book.get("loans", ""))))
                self.tableWidgetRequests.setItem(rowPosition , 7, QtWidgets.QTableWidgetItem(str(book.get("loaned", ""))))
                self.tableWidgetRequests.setItem(rowPosition , 8, QtWidgets.QTableWidgetItem(str(request.get("type", ""))))
                self.tableWidgetRequests.setItem(rowPosition , 9, QtWidgets.QTableWidgetItem(str(request.get("status", ""))))
                self.tableWidgetRequests.setItem(rowPosition , 10, QtWidgets.QTableWidgetItem(str(request.get("request date", ""))))
                self.tableWidgetRequests.setItem(rowPosition , 11, QtWidgets.QTableWidgetItem(str(request.get("duration", ""))))
        except Exception as e:
            QtWidgets.QMessageBox.critical(None, "Error", str(e))
    def refresh_top_books(self):
        try:
            self.tableWidget.setRowCount(0)
            for book in books.most_loaned(self.spinBoxLoaned.value()):
                rowPosition = self.tableWidget.rowCount()
                self.tableWidget.insertRow(rowPosition)
                self.tableWidget.setItem(rowPosition , 0, QtWidgets.QTableWidgetItem(book.get("title", "")))
                self.tableWidget.setItem(rowPosition , 1, QtWidgets.QTableWidgetItem(book.get("author", "")))
                self.tableWidget.setItem(rowPosition , 2, QtWidgets.QTableWidgetItem(book.get("category", "")))
                self.tableWidget.setItem(rowPosition , 3, QtWidgets.QTableWidgetItem(str(book.get("total count", ""))))
                self.tableWidget.setItem(rowPosition , 4, QtWidgets.QTableWidgetItem(str(book.get("available count", ""))))
                self.tableWidget.setItem(rowPosition , 5, QtWidgets.QTableWidgetItem(str(book.get("loans", ""))))
                self.tableWidget.setItem(rowPosition , 6, QtWidgets.QTableWidgetItem(str(book.get("loaned", ""))))
            self.spinBoxLoaned.setValue(10)
        except Exception as e:
            QtWidgets.QMessageBox.critical(None, "Error", str(e))

    def refresh_low_penalty(self):
        try:
            self.tableWidget_2.setRowCount(0)
            for user in users.low_penalty_users(self.spinBoxPenalty.value()):
                rowPosition = self.tableWidget_2.rowCount()
                self.tableWidget_2.insertRow(rowPosition)
                self.tableWidget_2.setItem(rowPosition , 0, QtWidgets.QTableWidgetItem(user.get("username", "")))
                self.tableWidget_2.setItem(rowPosition , 1, QtWidgets.QTableWidgetItem(user.get("name", "")))
                self.tableWidget_2.setItem(rowPosition , 2, QtWidgets.QTableWidgetItem(str(user.get("penalty", ""))))
            self.spinBoxPenalty.setValue(10)
        except Exception as e:
            QtWidgets.QMessageBox.critical(None, "Error", str(e))
    def clear_book_search(self):
        self.lineEditTitle2.setText("")
        self.lineEditAuthor2.setText("")
        self.lineEditCategory2.setText("")
        self.refresh_books()
    def refresh_books(self):
        try:
            self.tableWidgetBooks.setRowCount(0)
            for book in books.findbooks():
                rowPosition = self.tableWidgetBooks.rowCount()
                self.tableWidgetBooks.insertRow(rowPosition)
                self.tableWidgetBooks.setItem(rowPosition , 0, QtWidgets.QTableWidgetItem(book.get("title", "")))
                self.tableWidgetBooks.setItem(rowPosition , 1, QtWidgets.QTableWidgetItem(book.get("author", "")))
                self.tableWidgetBooks.setItem(rowPosition , 2, QtWidgets.QTableWidgetItem(book.get("category", "")))
                self.tableWidgetBooks.setItem(rowPosition , 3, QtWidgets.QTableWidgetItem(str(book.get("total count", ""))))
                self.tableWidgetBooks.setItem(rowPosition , 4, QtWidgets.QTableWidgetItem(str(book.get("available count", ""))))
                self.tableWidgetBooks.setItem(rowPosition , 5, QtWidgets.QTableWidgetItem(str(book.get("loans", ""))))
                self.tableWidgetBooks.setItem(rowPosition , 6, QtWidgets.QTableWidgetItem(str(book.get("loaned", ""))))
        except Exception as e:
            QtWidgets.QMessageBox.critical(None, "Error", str(e))
    def book_selection_changed(self):
        try:
        #should change model of selecting
            selected_rows = self.tableWidgetBooks.selectionModel().selectedRows()
            if selected_rows:
                self.pushButtonDeleteselected.setDisabled(0)
                self.pushButtonEditselected.setDisabled(0)
                selected_book = selected_rows[0]
                self.selected_book_title = selected_book.data(0)
                self.selected_book_author = selected_book.siblingAtColumn(1).data()
                self.lineEditTitle.setText(self.selected_book_title)
                self.lineEditAuthor.setText(self.selected_book_author)
                self.lineEditCategory.setText(selected_book.siblingAtColumn(2).data())
                self.spinBoxTotalcount.setValue(int(selected_book.siblingAtColumn(3).data()))
            else:
                self.pushButtonDeleteselected.setDisabled(1)
                self.pushButtonEditselected.setDisabled(1)
                self.selected_book = None
        except Exception as e:
            QtWidgets.QMessageBox.critical(None, "Error", str(e))
    
    def request_selection_changed(self):
        try:
            row = self.tableWidgetRequests.currentRow()
            if row == -1 or self.tableWidgetRequests.item(row, 9).text() != "pending":
                self.pushButtonAccept.setEnabled(False)
                self.pushButtonReject.setEnabled(False)
                return
            self.req_username = self.tableWidgetRequests.item(row, 0).text()
            self.req_book_title = self.tableWidgetRequests.item(row, 1).text()
            self.req_book_author = self.tableWidgetRequests.item(row, 2).text()
            self.pushButtonAccept.setEnabled(True)
            self.pushButtonReject.setEnabled(True)
        except Exception as e:
            QtWidgets.QMessageBox.critical(None, "Error", str(e))

    def accept_request(self):
        try:
            book_id = books.find_id(title=self.req_book_title, author=self.req_book_author)
            request = requests.find_request(self.req_username, book_id)
            book = books.findbooks(_id=book_id)
            if request.get("type") == "loan":
                if book["available count"] == 0:
                    raise Exception("This book is not available")
                books.editbook(available_count=book["available count"] - 1, loans_num=book["loans"] + 1, _id=request.get("book id", ""), loaned=book["loaned"] + 1)
                loans.add_loan(self.req_username, request.get("book id", ""), request.get("duration", ""))
            elif request.get("type") == "return":
                books.editbook(available_count=book["available count"] + 1, loans_num=book["loans"] - 1, _id=request.get("book id", ""))
                loans.del_loan(self.req_username, request.get("book id", ""))
            elif request.get("type") == "renew":
                books.editbook(_id=request.get("book id", ""), loaned=book["loaned"] + 1, available_count=book["available count"])
                loans.del_loan(self.req_username, request.get("book id", ""))
                loans.add_loan(self.req_username, request.get("book id", ""), request.get("duration", ""))
        except Exception as e:
            QtWidgets.QMessageBox.critical(None, "Error", str(e))
            return
        requests.change_status(request.get("_id", ""), "accepted")
        self.load_requests()
        self.refresh_books()
        QtWidgets.QMessageBox.information(None, "Success", "Request accepted")

    def reject_request(self):
        try:
            book_id = books.find_id(title=self.req_book_title, author=self.req_book_author)
            request = requests.find_request(self.req_username, book_id)
            if request.get("type") == "return":
                raise Exception("You cannot reject a return request")
            requests.change_status(request.get("_id", ""), "rejected")
            QtWidgets.QMessageBox.information(None, "Success", "Request rejected")
            self.load_requests()
        except Exception as e:
            QtWidgets.QMessageBox.critical(None, "Error", str(e))
            return
    def del_book(self):
        try:
            _id = books.find_id(title=self.selected_book_title, author=self.selected_book_author)
            requests.del_book(_id)
            books.delbook(_id)
            QtWidgets.QMessageBox.information(None, "Success", "Book deleted successfully")
            self.clear_book()
        except Exception as e:
            QtWidgets.QMessageBox.critical(None, "Error", str(e))

    def edit_book(self):
        try:
            _id = books.find_id(title=self.selected_book_title, author=self.selected_book_author)
            books.editbook(_id, self.lineEditTitle.text(), self.lineEditAuthor.text(), self.lineEditCategory.text(), self.spinBoxTotalcount.value(), auto=False)
            QtWidgets.QMessageBox.information(None, "Success", "Book edited successfully")
            self.clear_book()
        except Exception as e:
            QtWidgets.QMessageBox.critical(None, "Error", str(e))

    def clear_book(self):
        self.lineEditTitle.setText("")
        self.lineEditAuthor.setText("")
        self.lineEditCategory.setText("")
        self.spinBoxTotalcount.setValue(0)
        self.refresh_books()

    def user_selection_changed(self):
        try:
            selected_rows = self.tableWidgetUsers.selectionModel().selectedRows()
            if selected_rows:
                self.pushButtonDelete.setDisabled(0)
                self.pushButtonEnable.setDisabled(0)
                self.pushButtonDisable.setDisabled(0)
                self.selected_username = selected_rows[0].data()
            else:
                self.pushButtonDelete.setDisabled(1)
                self.pushButtonEnable.setDisabled(1)
                self.pushButtonDisable.setDisabled(1)
                self.selected_username = None
        except Exception as e:
            QtWidgets.QMessageBox.critical(None, "Error", str(e))

    def refresh_users(self):
        try:
            self.tableWidgetUsers.setRowCount(0)
            for user in users.getusers():
                rowPosition = self.tableWidgetUsers.rowCount()
                self.tableWidgetUsers.insertRow(rowPosition)
                self.tableWidgetUsers.setItem(rowPosition , 0, QtWidgets.QTableWidgetItem(user.get("username", "")))
                self.tableWidgetUsers.setItem(rowPosition , 1, QtWidgets.QTableWidgetItem(user.get("name", "")))
                self.tableWidgetUsers.setItem(rowPosition , 2, QtWidgets.QTableWidgetItem(user.get("role", "")))
                self.tableWidgetUsers.setItem(rowPosition , 3, QtWidgets.QTableWidgetItem(user.get("status", "")))
                self.tableWidgetUsers.setItem(rowPosition , 4, QtWidgets.QTableWidgetItem(str(user.get("penalty", ""))))
                self.tableWidgetUsers.setItem(rowPosition , 5, QtWidgets.QTableWidgetItem(str(user.get("loans", ""))))
        except Exception as e:
            QtWidgets.QMessageBox.critical(None, "Error", str(e))

    def findbooks(self):
        try:
            title = self.lineEditTitle2.text()
            author = self.lineEditAuthor2.text()
            category = self.lineEditCategory2.text()
            results = books.findbooks(title=title, author=author, category=category)
            self.tableWidgetBooks.setRowCount(0)
            for book in results:
                rowPosition = self.tableWidgetBooks.rowCount()
                self.tableWidgetBooks.insertRow(rowPosition)
                self.tableWidgetBooks.setItem(rowPosition , 0, QtWidgets.QTableWidgetItem(book.get("title", "")))
                self.tableWidgetBooks.setItem(rowPosition , 1, QtWidgets.QTableWidgetItem(book.get("author", "")))
                self.tableWidgetBooks.setItem(rowPosition , 2, QtWidgets.QTableWidgetItem(book.get("category", "")))
                self.tableWidgetBooks.setItem(rowPosition , 3, QtWidgets.QTableWidgetItem(str(book.get("total count", ""))))
                self.tableWidgetBooks.setItem(rowPosition , 4, QtWidgets.QTableWidgetItem(str(book.get("available count", ""))))
                self.tableWidgetBooks.setItem(rowPosition , 5, QtWidgets.QTableWidgetItem(str(book.get("loans", ""))))
                self.tableWidgetBooks.setItem(rowPosition , 6, QtWidgets.QTableWidgetItem(str(book.get("loaned", ""))))
        except Exception as e:
            QtWidgets.QMessageBox.critical(None, "Error", str(e))
    def add_book(self):
        title = self.lineEditTitle.text()
        author = self.lineEditAuthor.text()
        category = self.lineEditCategory.text()
        total_count = self.spinBoxTotalcount.value()
        try:
            books.addbook(title, author, category, total_count)
            QtWidgets.QMessageBox.information(None, "Success", "Book added successfully")
            self.clear_book()
        except Exception as e:
            QtWidgets.QMessageBox.critical(None, "Error", str(e))
    def add_user(self):
        username = self.lineEditUsername.text()
        password = self.lineEditPassword.text()
        name = self.lineEditName.text()
        role = self.comboBoxRole.currentText()
        try:
            users.adduser(username, password, name, role)
            QtWidgets.QMessageBox.information(None, "Success", "User added successfully")
            self.refresh_users()
        except Exception as e:
            QtWidgets.QMessageBox.critical(None, "Error", str(e))

    def del_user(self):
        try:
            if self.selected_username == self.username:
                raise Exception("You cannot delete yourself")
            if loans.my_loans(self.selected_username) != []:
                raise Exception("This user has active loans; cannot delete.")
            requests.del_request_user(self.selected_username)
            users.deluser(self.selected_username)
            QtWidgets.QMessageBox.information(None, "Success", "User deleted successfully")
            self.refresh_users()
        except Exception as e:
            QtWidgets.QMessageBox.critical(None, "Error", str(e))

    def enable_user(self):
        try:
            users.enable(self.selected_username)
            QtWidgets.QMessageBox.information(None, "Success", "User enabled successfully")
            self.refresh_users()
        except Exception as e:
            QtWidgets.QMessageBox.critical(None, "Error", str(e))
    
    def disable_user(self):
        try:
            if self.selected_username == self.username:
                raise Exception("You cannot disable yourself")
            users.disable(self.selected_username)
            QtWidgets.QMessageBox.information(None, "Success", "User disabled successfully")
            self.refresh_users()
        except Exception as e:
            QtWidgets.QMessageBox.critical(None, "Error", str(e))

if __name__ == "__main__":
    import sys
    app = QtWidgets.QApplication(sys.argv)
    MainWindow = QtWidgets.QMainWindow()
    ui = Ui_MainWindow("admin", "admin")
    ui.setupUi(MainWindow)
    MainWindow.show()
    sys.exit(app.exec())
